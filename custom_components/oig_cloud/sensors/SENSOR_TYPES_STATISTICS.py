"""Definice statistick√Ωch senzor≈Ø pro OIG Cloud."""

from typing import List, Dict, Any
from homeassistant.components.sensor import SensorDeviceClass, SensorStateClass
from homeassistant.helpers.entity import EntityCategory
from homeassistant.const import UnitOfPower, UnitOfEnergy, UnitOfTime, PERCENTAGE

# Seznam statistick√Ωch senzor≈Ø s jejich konfigurac√≠
SENSOR_TYPES_STATISTICS: Dict[str, Dict[str, Any]] = {
    # Z√°kladn√≠ odbƒõr - medi√°n za posledn√≠ch 10 minut
    "battery_load_median": {
        "name": "Load Median 10 Minutes",
        "name_cs": "Medi√°n odbƒõru za 10 minut",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-line",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "sampling_minutes": 10,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "description": "Medi√°n celkov√©ho odbƒõru dom√°cnosti za posledn√≠ch 10 minut",
    },
    # V√≠kend vs v≈°edn√≠ den odbƒõr po ƒçasov√Ωch √∫sec√≠ch
    "load_avg_6_8_weekday": {
        "name": "Average Load 6-8h Weekday",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 6-8h (v≈°edn√≠ dny)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (6, 8),
        "day_type": "weekday",
        "statistic": "median",
        "max_age_days": 30,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
    },
    "load_avg_8_12_weekday": {
        "name": "Average Load 8-12h Weekday",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 8-12h (v≈°edn√≠ dny)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (8, 12),
        "day_type": "weekday",
        "statistic": "median",
        "max_age_days": 30,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
    },
    "load_avg_12_16_weekday": {
        "name": "Average Load 12-16h Weekday",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 12-16h (v≈°edn√≠ dny)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (12, 16),
        "day_type": "weekday",
        "statistic": "median",
        "max_age_days": 30,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
    },
    "load_avg_16_22_weekday": {
        "name": "Average Load 16-22h Weekday",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 16-22h (v≈°edn√≠ dny)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (16, 22),
        "day_type": "weekday",
        "statistic": "median",
        "max_age_days": 30,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
    },
    "load_avg_22_6_weekday": {
        "name": "Average Load 22-6h Weekday",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 22-6h (v≈°edn√≠ dny)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (22, 6),  # p≈ôes p≈Ølnoc
        "day_type": "weekday",
        "statistic": "median",
        "max_age_days": 30,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
    },
    # V√≠kendov√© varianty
    "load_avg_6_8_weekend": {
        "name": "Average Load 6-8h Weekend",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 6-8h (v√≠kendy)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (6, 8),
        "day_type": "weekend",
        "statistic": "median",
        "max_age_days": 30,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
    },
    "load_avg_8_12_weekend": {
        "name": "Average Load 8-12h Weekend",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 8-12h (v√≠kendy)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (8, 12),
        "day_type": "weekend",
        "statistic": "median",
        "max_age_days": 30,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
    },
    "load_avg_12_16_weekend": {
        "name": "Average Load 12-16h Weekend",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 12-16h (v√≠kendy)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (12, 16),
        "day_type": "weekend",
        "statistic": "median",
        "max_age_days": 30,
        "sampling_size": 500,
        "sensor_type_category": "statistics",
    },
    "load_avg_16_22_weekend": {
        "name": "Average Load 16-22h Weekend",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 16-22h (v√≠kendy)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (16, 22),
        "day_type": "weekend",
        "statistic": "median",
        "max_age_days": 30,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
    },
    "load_avg_22_6_weekend": {
        "name": "Average Load 22-6h Weekend",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 22-6h (v√≠kendy)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (22, 6),
        "day_type": "weekend",
        "statistic": "median",
        "max_age_days": 30,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
    },
    # Predikƒçn√≠ senzory - ODSTRANƒöNO: battery_prediction_discharge_time, battery_prediction_needed_capacity, battery_prediction_morning_soc
    # Tyto senzory byly nahrazeny battery_forecast sensorem
    # Hodinov√© re√°ln√© senzory - pou≈æ√≠vaj√≠ existuj√≠c√≠ computed energy senzory
    "hourly_real_battery_charge_kwh": {
        "name": "Hourly Battery Charge",
        "name_cs": "Hodinov√© nab√≠jen√≠ baterie",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:battery-plus",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "hourly_data_type": "energy_diff",
        "source_sensor": "computed_batt_charge_energy_today",
        "description": "Re√°ln√© nab√≠jen√≠ baterie za posledn√≠ hodinu",
    },
    "hourly_real_battery_discharge_kwh": {
        "name": "Hourly Battery Discharge",
        "name_cs": "Hodinov√© vyb√≠jen√≠ baterie",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:battery-minus",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "hourly_data_type": "energy_diff",
        "source_sensor": "computed_batt_discharge_energy_today",
        "description": "Re√°ln√© vyb√≠jen√≠ baterie za posledn√≠ hodinu",
    },
    "hourly_real_fve_total_kwh": {
        "name": "Hourly FVE Production",
        "name_cs": "Hodinov√° v√Ωroba FVE",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:solar-power",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "hourly_data_type": "power_integral",
        "source_sensor": "actual_fv_total",
        "description": "Re√°ln√° celkov√° v√Ωroba FVE za posledn√≠ hodinu",
    },
    "hourly_real_load_kwh": {
        "name": "Hourly Load Consumption",
        "name_cs": "Hodinov√° spot≈ôeba z√°tƒõ≈æe",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:home-lightning-bolt",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "hourly_data_type": "power_integral",
        "source_sensor": "actual_aco_p",
        "description": "Re√°ln√° spot≈ôeba za posledn√≠ hodinu",
    },
    "hourly_real_boiler_kwh": {
        "name": "Hourly Boiler Consumption",
        "name_cs": "Hodinov√° spot≈ôeba bojleru",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:water-boiler",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "hourly_data_type": "energy_diff",
        "source_sensor": "boiler_day_w",
        "description": "Re√°ln√° spot≈ôeba bojleru za posledn√≠ hodinu",
    },
    # Hodinov√© FVE stringy
    "hourly_real_fve_string_1_kwh": {
        "name": "Hourly FVE String 1 Production",
        "name_cs": "Hodinov√° v√Ωroba FVE string 1",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:solar-panel",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "hourly_data_type": "power_integral",
        "source_sensor": "actual_fv_p1",
        "description": "Re√°ln√° v√Ωroba FVE string 1 za posledn√≠ hodinu",
    },
    "hourly_real_fve_string_2_kwh": {
        "name": "Hourly FVE String 2 Production",
        "name_cs": "Hodinov√° v√Ωroba FVE string 2",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:solar-panel",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "hourly_data_type": "power_integral",
        "source_sensor": "actual_fv_p2",
        "description": "Re√°ln√° v√Ωroba FVE string 2 za posledn√≠ hodinu",
    },
    # ====================================================================================
    # OPTIMALIZACE NAB√çJEN√ç BATERIE - Rozdƒõleno podle 3 hlavn√≠ch c√≠l≈Ø
    # ====================================================================================
    # üéØ C√çL 1: AUTOMATIZACE NAB√çJEN√ç - Senzory pro automatizaƒçn√≠ pravidla
    # ====================================================================================
    # Hlavn√≠ predikƒçn√≠ senzor - KAPACITA BATERIE V PR≈ÆBƒöHU DNE
    "battery_forecast": {
        "name": "Battery Capacity Forecast",
        "name_cs": "Predikce kapacity baterie",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:battery-charging-80",
        "device_class": SensorDeviceClass.ENERGY_STORAGE,
        "state_class": SensorStateClass.MEASUREMENT,
        "sensor_type_category": "battery_prediction",  # Hlavn√≠ senzor - vytv√°≈ô√≠ OigCloudBatteryForecastSensor
        "entity_category": EntityCategory.DIAGNOSTIC,
        "description": "Aktu√°ln√≠ predikovan√° kapacita baterie (kWh). Atributy obsahuj√≠ kompletn√≠ timeline predikce.",
    },
}
