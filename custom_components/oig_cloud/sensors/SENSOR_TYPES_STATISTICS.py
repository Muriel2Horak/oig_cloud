"""Definice statistick칳ch senzor콢 pro OIG Cloud."""

from typing import Any, Dict

from homeassistant.components.sensor import SensorDeviceClass, SensorStateClass
from homeassistant.const import PERCENTAGE, EntityCategory, UnitOfEnergy, UnitOfPower

ICON_TIMELINE_VARIANT = "mdi:chart-timeline-variant"

# Seznam statistick칳ch senzor콢 s jejich konfigurac칤
SENSOR_TYPES_STATISTICS: Dict[str, Dict[str, Any]] = {
    # Z치kladn칤 odb캩r - medi치n za posledn칤ch 10 minut
    "battery_load_median": {
        "name": "Load Median 10 Minutes",
        "name_cs": "Medi치n odb캩ru za 10 minut",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-line",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "sampling_minutes": 10,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
        "description": "Medi치n celkov칠ho odb캩ru dom치cnosti za posledn칤ch 10 minut",
    },
    # V칤kend vs v코edn칤 den odb캩r po 캜asov칳ch 칰sec칤ch
    "load_avg_6_8_weekday": {
        "name": "Average Load 6-8h Weekday",
        "name_cs": "Pr콢m캩rn칳 odb캩r 6-8h (v코edn칤 dny)",
        "unit": UnitOfPower.WATT,
        "icon": ICON_TIMELINE_VARIANT,
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (6, 8),
        "day_type": "weekday",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    "load_avg_8_12_weekday": {
        "name": "Average Load 8-12h Weekday",
        "name_cs": "Pr콢m캩rn칳 odb캩r 8-12h (v코edn칤 dny)",
        "unit": UnitOfPower.WATT,
        "icon": ICON_TIMELINE_VARIANT,
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (8, 12),
        "day_type": "weekday",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    "load_avg_12_16_weekday": {
        "name": "Average Load 12-16h Weekday",
        "name_cs": "Pr콢m캩rn칳 odb캩r 12-16h (v코edn칤 dny)",
        "unit": UnitOfPower.WATT,
        "icon": ICON_TIMELINE_VARIANT,
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (12, 16),
        "day_type": "weekday",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    "load_avg_16_22_weekday": {
        "name": "Average Load 16-22h Weekday",
        "name_cs": "Pr콢m캩rn칳 odb캩r 16-22h (v코edn칤 dny)",
        "unit": UnitOfPower.WATT,
        "icon": ICON_TIMELINE_VARIANT,
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (16, 22),
        "day_type": "weekday",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    "load_avg_22_6_weekday": {
        "name": "Average Load 22-6h Weekday",
        "name_cs": "Pr콢m캩rn칳 odb캩r 22-6h (v코edn칤 dny)",
        "unit": UnitOfPower.WATT,
        "icon": ICON_TIMELINE_VARIANT,
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (22, 6),  # p콏es p콢lnoc
        "day_type": "weekday",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    # V칤kendov칠 varianty
    "load_avg_6_8_weekend": {
        "name": "Average Load 6-8h Weekend",
        "name_cs": "Pr콢m캩rn칳 odb캩r 6-8h (v칤kendy)",
        "unit": UnitOfPower.WATT,
        "icon": ICON_TIMELINE_VARIANT,
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (6, 8),
        "day_type": "weekend",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    "load_avg_8_12_weekend": {
        "name": "Average Load 8-12h Weekend",
        "name_cs": "Pr콢m캩rn칳 odb캩r 8-12h (v칤kendy)",
        "unit": UnitOfPower.WATT,
        "icon": ICON_TIMELINE_VARIANT,
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (8, 12),
        "day_type": "weekend",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    "load_avg_12_16_weekend": {
        "name": "Average Load 12-16h Weekend",
        "name_cs": "Pr콢m캩rn칳 odb캩r 12-16h (v칤kendy)",
        "unit": UnitOfPower.WATT,
        "icon": ICON_TIMELINE_VARIANT,
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (12, 16),
        "day_type": "weekend",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 500,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    "load_avg_16_22_weekend": {
        "name": "Average Load 16-22h Weekend",
        "name_cs": "Pr콢m캩rn칳 odb캩r 16-22h (v칤kendy)",
        "unit": UnitOfPower.WATT,
        "icon": ICON_TIMELINE_VARIANT,
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (16, 22),
        "day_type": "weekend",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    "load_avg_22_6_weekend": {
        "name": "Average Load 22-6h Weekend",
        "name_cs": "Pr콢m캩rn칳 odb캩r 22-6h (v칤kendy)",
        "unit": UnitOfPower.WATT,
        "icon": ICON_TIMELINE_VARIANT,
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (22, 6),
        "day_type": "weekend",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    # Predik캜n칤 senzory - ODSTRAN캨NO: battery_prediction_discharge_time, battery_prediction_needed_capacity, battery_prediction_morning_soc
    # Tyto senzory byly nahrazeny battery_forecast sensorem
    # Hodinov칠 re치ln칠 senzory - pou쮂셨aj칤 existuj칤c칤 computed energy senzory
    "hourly_real_battery_charge_kwh": {
        "name": "Hourly Battery Charge",
        "name_cs": "Hodinov칠 nab칤jen칤 baterie",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:battery-plus",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
        "hourly_data_type": "energy_diff",
        "source_sensor": "computed_batt_charge_energy_today",
        "description": "Re치ln칠 nab칤jen칤 baterie za posledn칤 hodinu",
    },
    "hourly_real_battery_discharge_kwh": {
        "name": "Hourly Battery Discharge",
        "name_cs": "Hodinov칠 vyb칤jen칤 baterie",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:battery-minus",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
        "hourly_data_type": "energy_diff",
        "source_sensor": "computed_batt_discharge_energy_today",
        "description": "Re치ln칠 vyb칤jen칤 baterie za posledn칤 hodinu",
    },
    "hourly_real_fve_total_kwh": {
        "name": "Hourly FVE Production",
        "name_cs": "Hodinov치 v칳roba FVE",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:solar-power",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
        "hourly_data_type": "power_integral",
        "source_sensor": "actual_fv_total",
        "description": "Re치ln치 celkov치 v칳roba FVE za posledn칤 hodinu",
    },
    "hourly_real_load_kwh": {
        "name": "Hourly Load Consumption",
        "name_cs": "Hodinov치 spot콏eba z치t캩쬰",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:home-lightning-bolt",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
        "hourly_data_type": "power_integral",
        "source_sensor": "actual_aco_p",
        "description": "Re치ln치 spot콏eba za posledn칤 hodinu",
    },
    "hourly_real_boiler_kwh": {
        "name": "Hourly Boiler Consumption",
        "name_cs": "Hodinov치 spot콏eba bojleru",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:water-boiler",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
        "hourly_data_type": "energy_diff",
        "source_sensor": "boiler_day_w",
        "description": "Re치ln치 spot콏eba bojleru za posledn칤 hodinu",
    },
    # Hodinov칠 FVE stringy
    "hourly_real_fve_string_1_kwh": {
        "name": "Hourly FVE String 1 Production",
        "name_cs": "Hodinov치 v칳roba FVE string 1",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:solar-panel",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
        "hourly_data_type": "power_integral",
        "source_sensor": "actual_fv_p1",
        "description": "Re치ln치 v칳roba FVE string 1 za posledn칤 hodinu",
    },
    "hourly_real_fve_string_2_kwh": {
        "name": "Hourly FVE String 2 Production",
        "name_cs": "Hodinov치 v칳roba FVE string 2",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:solar-panel",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
        "hourly_data_type": "power_integral",
        "source_sensor": "actual_fv_p2",
        "description": "Re치ln치 v칳roba FVE string 2 za posledn칤 hodinu",
    },
    # ====================================================================================
    # OPTIMALIZACE NAB칈JEN칈 BATERIE - Rozd캩leno podle 3 hlavn칤ch c칤l콢
    # ====================================================================================
    # 游꿢 C칈L 1: AUTOMATIZACE NAB칈JEN칈 - Senzory pro automatiza캜n칤 pravidla
    # ====================================================================================
    # Hlavn칤 predik캜n칤 senzor - KAPACITA BATERIE V PR콡B캨HU DNE
    "battery_forecast": {
        "name": "Battery Capacity Forecast",
        "name_cs": "Predikce kapacity baterie",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:battery-charging-80",
        "device_class": SensorDeviceClass.ENERGY_STORAGE,
        "state_class": SensorStateClass.MEASUREMENT,
        "sensor_type_category": "battery_prediction",
        "device_mapping": "analytics",  # Hlavn칤 senzor - vytv치콏칤 OigCloudBatteryForecastSensor
        "entity_category": EntityCategory.DIAGNOSTIC,
        "description": "Aktu치ln칤 predikovan치 kapacita baterie (kWh). Atributy obsahuj칤 kompletn칤 timeline predikce.",
    },
    "planner_recommended_mode": {
        "name": "Planner Recommended Mode",
        "name_cs": "Doporu캜en칳 re쬴m (pl치nova캜)",
        "unit": None,
        "icon": "mdi:robot",
        "device_class": None,
        "state_class": None,
        "sensor_type_category": "planner_status",
        "device_mapping": "analytics",
        "entity_category": EntityCategory.DIAGNOSTIC,
        "description": "Doporu캜en칳 re쬴m pro aktu치ln칤 interval z hybrid pl치nova캜e (nap콏. Home 1/Home UPS) + informace o p콏칤코t칤 zm캩n캩.",
    },
    "battery_balancing": {
        "name": "Battery Balancing Status",
        "name_cs": "Stav vyrovn치n칤 baterie",
        "unit": None,
        "icon": "mdi:battery-heart-variant",
        "device_class": None,
        "state_class": None,
        "sensor_type_category": "battery_balancing",
        "device_mapping": "analytics",  # Specializovan칳 senzor pro battery balancing
        "entity_category": EntityCategory.DIAGNOSTIC,
        "description": "Stav vyrovn치n칤 캜l치nk콢 baterie. Zobrazuje kdy bylo posledn칤 vyrovn치n칤, kolik dn칤 uplynulo, zda je napl치nov치no dal코칤 a p콏edpokl치dan칠 n치klady.",
    },
    "grid_charging_planned": {
        "name": "Grid Charging Planned",
        "name_cs": "Pl치novan칠 nab칤jen칤 ze s칤t캩",
        "unit": None,  # Binary sensor (on/off)
        "icon": "mdi:battery-charging",
        "device_class": None,  # Binary sensor bez device class
        "state_class": None,  # Binary sensor nem치 state class
        "sensor_type_category": "grid_charging_plan",
        "device_mapping": "analytics",  # Specializovan칳 senzor
        "entity_category": None,  # Hlavn칤 senzor, ne diagnostic
        "description": "Indik치tor pl치novan칠ho nab칤jen칤 baterie ze s칤t캩 (on/off). Atributy obsahuj칤 intervaly nab칤jen칤, celkovou energii (kWh) a cenu (K캜).",
    },
    "battery_efficiency": {
        "name": "Battery Efficiency",
        "name_cs": "Efektivita baterie (m캩s칤c)",
        "unit": PERCENTAGE,
        "icon": "mdi:battery-sync",
        "device_class": None,
        "state_class": SensorStateClass.MEASUREMENT,
        "sensor_type_category": "battery_efficiency",
        "device_mapping": "analytics",
        "entity_category": None,
        "description": "Round-trip efektivita baterie za minul칳 kompletn칤 m캩s칤c (%). Atributy obsahuj칤 pr콢b캩쬹치 data aktu치ln칤ho m캩s칤ce a detailn칤 metriky.",
    },
    "adaptive_load_profiles": {
        "name": "Adaptive Load Profiles",
        "name_cs": "Adaptivn칤 profily spot콏eby",
        "unit": None,  # State = po캜et profil콢
        "icon": "mdi:chart-timeline-variant-shimmer",
        "device_class": None,
        "state_class": None,
        "sensor_type_category": "adaptive_profiles",
        "device_mapping": "analytics",
        "entity_category": EntityCategory.DIAGNOSTIC,
        "description": "Automaticky generovan칠 profily spot콏eby zalo쬰n칠 na historick칳ch datech. State = po캜et profil콢, attributes = detaily jednotliv칳ch profil콢.",
    },
}
