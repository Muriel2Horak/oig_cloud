"""Definice statistick√Ωch senzor≈Ø pro OIG Cloud."""

from typing import List, Dict, Any
from homeassistant.components.sensor import SensorDeviceClass, SensorStateClass
from homeassistant.const import (
    UnitOfPower,
    UnitOfEnergy,
    UnitOfTime,
    PERCENTAGE,
    EntityCategory,
)

# Seznam statistick√Ωch senzor≈Ø s jejich konfigurac√≠
SENSOR_TYPES_STATISTICS: Dict[str, Dict[str, Any]] = {
    # Z√°kladn√≠ odbƒõr - medi√°n za posledn√≠ch 10 minut
    "battery_load_median": {
        "name": "Load Median 10 Minutes",
        "name_cs": "Medi√°n odbƒõru za 10 minut",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-line",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "sampling_minutes": 10,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
        "description": "Medi√°n celkov√©ho odbƒõru dom√°cnosti za posledn√≠ch 10 minut",
    },
    # V√≠kend vs v≈°edn√≠ den odbƒõr po ƒçasov√Ωch √∫sec√≠ch
    "load_avg_6_8_weekday": {
        "name": "Average Load 6-8h Weekday",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 6-8h (v≈°edn√≠ dny)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (6, 8),
        "day_type": "weekday",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    "load_avg_8_12_weekday": {
        "name": "Average Load 8-12h Weekday",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 8-12h (v≈°edn√≠ dny)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (8, 12),
        "day_type": "weekday",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    "load_avg_12_16_weekday": {
        "name": "Average Load 12-16h Weekday",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 12-16h (v≈°edn√≠ dny)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (12, 16),
        "day_type": "weekday",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    "load_avg_16_22_weekday": {
        "name": "Average Load 16-22h Weekday",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 16-22h (v≈°edn√≠ dny)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (16, 22),
        "day_type": "weekday",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    "load_avg_22_6_weekday": {
        "name": "Average Load 22-6h Weekday",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 22-6h (v≈°edn√≠ dny)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (22, 6),  # p≈ôes p≈Ølnoc
        "day_type": "weekday",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    # V√≠kendov√© varianty
    "load_avg_6_8_weekend": {
        "name": "Average Load 6-8h Weekend",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 6-8h (v√≠kendy)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (6, 8),
        "day_type": "weekend",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    "load_avg_8_12_weekend": {
        "name": "Average Load 8-12h Weekend",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 8-12h (v√≠kendy)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (8, 12),
        "day_type": "weekend",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    "load_avg_12_16_weekend": {
        "name": "Average Load 12-16h Weekend",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 12-16h (v√≠kendy)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (12, 16),
        "day_type": "weekend",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 500,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    "load_avg_16_22_weekend": {
        "name": "Average Load 16-22h Weekend",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 16-22h (v√≠kendy)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (16, 22),
        "day_type": "weekend",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    "load_avg_22_6_weekend": {
        "name": "Average Load 22-6h Weekend",
        "name_cs": "Pr≈Ømƒõrn√Ω odbƒõr 22-6h (v√≠kendy)",
        "unit": UnitOfPower.WATT,
        "icon": "mdi:chart-timeline-variant",
        "device_class": SensorDeviceClass.POWER,
        "state_class": SensorStateClass.MEASUREMENT,
        "time_range": (22, 6),
        "day_type": "weekend",
        "statistic": "median",
        "max_age_days": 14,
        "sampling_size": 1000,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
    },
    # Predikƒçn√≠ senzory - ODSTRANƒöNO: battery_prediction_discharge_time, battery_prediction_needed_capacity, battery_prediction_morning_soc
    # Tyto senzory byly nahrazeny battery_forecast sensorem
    # Hodinov√© re√°ln√© senzory - pou≈æ√≠vaj√≠ existuj√≠c√≠ computed energy senzory
    "hourly_real_battery_charge_kwh": {
        "name": "Hourly Battery Charge",
        "name_cs": "Hodinov√© nab√≠jen√≠ baterie",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:battery-plus",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
        "hourly_data_type": "energy_diff",
        "source_sensor": "computed_batt_charge_energy_today",
        "description": "Re√°ln√© nab√≠jen√≠ baterie za posledn√≠ hodinu",
    },
    "hourly_real_battery_discharge_kwh": {
        "name": "Hourly Battery Discharge",
        "name_cs": "Hodinov√© vyb√≠jen√≠ baterie",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:battery-minus",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
        "hourly_data_type": "energy_diff",
        "source_sensor": "computed_batt_discharge_energy_today",
        "description": "Re√°ln√© vyb√≠jen√≠ baterie za posledn√≠ hodinu",
    },
    "hourly_real_fve_total_kwh": {
        "name": "Hourly FVE Production",
        "name_cs": "Hodinov√° v√Ωroba FVE",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:solar-power",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
        "hourly_data_type": "power_integral",
        "source_sensor": "actual_fv_total",
        "description": "Re√°ln√° celkov√° v√Ωroba FVE za posledn√≠ hodinu",
    },
    "hourly_real_load_kwh": {
        "name": "Hourly Load Consumption",
        "name_cs": "Hodinov√° spot≈ôeba z√°tƒõ≈æe",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:home-lightning-bolt",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
        "hourly_data_type": "power_integral",
        "source_sensor": "actual_aco_p",
        "description": "Re√°ln√° spot≈ôeba za posledn√≠ hodinu",
    },
    "hourly_real_boiler_kwh": {
        "name": "Hourly Boiler Consumption",
        "name_cs": "Hodinov√° spot≈ôeba bojleru",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:water-boiler",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
        "hourly_data_type": "energy_diff",
        "source_sensor": "boiler_day_w",
        "description": "Re√°ln√° spot≈ôeba bojleru za posledn√≠ hodinu",
    },
    # Hodinov√© FVE stringy
    "hourly_real_fve_string_1_kwh": {
        "name": "Hourly FVE String 1 Production",
        "name_cs": "Hodinov√° v√Ωroba FVE string 1",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:solar-panel",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
        "hourly_data_type": "power_integral",
        "source_sensor": "actual_fv_p1",
        "description": "Re√°ln√° v√Ωroba FVE string 1 za posledn√≠ hodinu",
    },
    "hourly_real_fve_string_2_kwh": {
        "name": "Hourly FVE String 2 Production",
        "name_cs": "Hodinov√° v√Ωroba FVE string 2",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:solar-panel",
        "device_class": SensorDeviceClass.ENERGY,
        "state_class": SensorStateClass.TOTAL,
        "entity_category": EntityCategory.DIAGNOSTIC,
        "sensor_type_category": "statistics",
        "device_mapping": "analytics",
        "hourly_data_type": "power_integral",
        "source_sensor": "actual_fv_p2",
        "description": "Re√°ln√° v√Ωroba FVE string 2 za posledn√≠ hodinu",
    },
    # ====================================================================================
    # OPTIMALIZACE NAB√çJEN√ç BATERIE - Rozdƒõleno podle 3 hlavn√≠ch c√≠l≈Ø
    # ====================================================================================
    # üéØ C√çL 1: AUTOMATIZACE NAB√çJEN√ç - Senzory pro automatizaƒçn√≠ pravidla
    # ====================================================================================
    # Hlavn√≠ predikƒçn√≠ senzor - KAPACITA BATERIE V PR≈ÆBƒöHU DNE
    "battery_forecast": {
        "name": "Battery Capacity Forecast",
        "name_cs": "Predikce kapacity baterie",
        "unit": UnitOfEnergy.KILO_WATT_HOUR,
        "icon": "mdi:battery-charging-80",
        "device_class": SensorDeviceClass.ENERGY_STORAGE,
        "state_class": SensorStateClass.MEASUREMENT,
        "sensor_type_category": "battery_prediction",
        "device_mapping": "analytics",  # Hlavn√≠ senzor - vytv√°≈ô√≠ OigCloudBatteryForecastSensor
        "entity_category": EntityCategory.DIAGNOSTIC,
        "description": "Aktu√°ln√≠ predikovan√° kapacita baterie (kWh). Atributy obsahuj√≠ kompletn√≠ timeline predikce.",
    },
    "battery_balancing": {
        "name": "Battery Balancing Status",
        "name_cs": "Stav vyrovn√°n√≠ baterie",
        "unit": None,
        "icon": "mdi:battery-heart-variant",
        "device_class": None,
        "state_class": None,
        "sensor_type_category": "battery_balancing",
        "device_mapping": "analytics",  # Specializovan√Ω senzor pro battery balancing
        "entity_category": EntityCategory.DIAGNOSTIC,
        "description": "Stav vyrovn√°n√≠ ƒçl√°nk≈Ø baterie. Zobrazuje kdy bylo posledn√≠ vyrovn√°n√≠, kolik dn√≠ uplynulo, zda je napl√°nov√°no dal≈°√≠ a p≈ôedpokl√°dan√© n√°klady.",
    },
    "grid_charging_planned": {
        "name": "Grid Charging Planned",
        "name_cs": "Pl√°novan√© nab√≠jen√≠ ze s√≠tƒõ",
        "unit": None,  # Binary sensor (on/off)
        "icon": "mdi:battery-charging",
        "device_class": None,  # Binary sensor bez device class
        "state_class": None,  # Binary sensor nem√° state class
        "sensor_type_category": "grid_charging_plan",
        "device_mapping": "analytics",  # Specializovan√Ω senzor
        "entity_category": None,  # Hlavn√≠ senzor, ne diagnostic
        "description": "Indik√°tor pl√°novan√©ho nab√≠jen√≠ baterie ze s√≠tƒõ (on/off). Atributy obsahuj√≠ intervaly nab√≠jen√≠, celkovou energii (kWh) a cenu (Kƒç).",
    },
    "battery_efficiency": {
        "name": "Battery Efficiency",
        "name_cs": "Efektivita baterie (mƒõs√≠c)",
        "unit": PERCENTAGE,
        "icon": "mdi:battery-sync",
        "device_class": None,
        "state_class": SensorStateClass.MEASUREMENT,
        "sensor_type_category": "battery_efficiency",
        "device_mapping": "analytics",
        "entity_category": None,
        "description": "Round-trip efektivita baterie za minul√Ω kompletn√≠ mƒõs√≠c (%). Atributy obsahuj√≠ pr≈Øbƒõ≈æn√° data aktu√°ln√≠ho mƒõs√≠ce a detailn√≠ metriky.",
    },
    "adaptive_load_profiles": {
        "name": "Adaptive Load Profiles",
        "name_cs": "Adaptivn√≠ profily spot≈ôeby",
        "unit": None,  # State = poƒçet profil≈Ø
        "icon": "mdi:chart-timeline-variant-shimmer",
        "device_class": None,
        "state_class": None,
        "sensor_type_category": "adaptive_profiles",
        "device_mapping": "analytics",
        "entity_category": EntityCategory.DIAGNOSTIC,
        "description": "Automaticky generovan√© profily spot≈ôeby zalo≈æen√© na historick√Ωch datech. State = poƒçet profil≈Ø, attributes = detaily jednotliv√Ωch profil≈Ø.",
    },
}
